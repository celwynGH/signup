<!DOCTYPE html>
<html>
<head>
    <title>Login & Sign Up</title>
    <style>
        body { font-family: sans-serif; display: flex; justify-content: center; padding: 50px; }
        .form-box { border: 1px solid #ccc; padding: 20px; border-radius: 8px; width: 300px; }
        input { width: 90%; margin-bottom: 10px; padding: 8px; }
        button { width: 100%; padding: 10px; cursor: pointer; margin-top: 5px; }
    </style>
</head>
<body>

<div class="form-box">
    <h2 id="title">Sign Up</h2>
    <input type="email" id="email" placeholder="Email" required>
    <input type="password" id="password" placeholder="Password" required>
    <button onclick="submitForm('signup')" id="mainBtn">Create Account</button>
    <p id="msg"></p>
    <hr>
    <button onclick="toggleMode()">Switch to Login</button>
</div>

<script>
    // PASTE YOUR GOOGLE DEPLOYMENT URL HERE
    const scriptURL = 'https://script.google.com/macros/s/AKfycbx_oWJ0J_mb7bms0L-273CGsWW_6n6Gjk5qAnyrVzu1g1VNM7kxjJrvATGRGL-mFRCGAA/exec';
    let isSignup = true;

    function toggleMode() {
        isSignup = !isSignup;
        document.getElementById('title').innerText = isSignup ? "Sign Up" : "Login";
        document.getElementById('mainBtn').innerText = isSignup ? "Create Account" : "Login";
    }

    function submitForm() {
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;
    const currentAction = isSignup ? 'signup' : 'login';
    const msgBox = document.getElementById('msg');

    msgBox.innerText = "Processing...";

    // We use a GET request here for simplicity with Google Apps Script web apps
    fetch(`${scriptURL}?action=${currentAction}&email=${email}&password=${password}`, { method: 'POST' })
        .then(res => res.text())
        .then(data => {
            msgBox.innerText = data;

            if (data.trim() === "Login Successful") {
                // 1. Save the user's email so the dashboard knows who they are
                localStorage.setItem("userEmail", email);
                
                // 2. Redirect to your dashboard file
                // If your dashboard is a separate file named dashboard.html:
                window.location.href = "dashboard.html"; 
            } else if (data.trim() === "Signup Successful") {
                alert("Account created! Please log in now.");
                toggleMode(); // Switch them to the login screen automatically
            }
        })
        .catch(error => {
            msgBox.innerText = "Error connecting to database.";
            console.error('Error!', error.message);
        });
}
</script>

</body>
</html>